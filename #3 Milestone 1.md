As I started working on this project, I quickly realised that the crossover between Subway Surfers and BeatSaber will not work. One evening I was scrolling through TikTok and I saw a guy playing a game called Rift of the Necrodancer, which had very similar layout and gameplay to the one I had imagined for this project. I started by creating a 6 units wide 8 units long spawning platform for the enemies to move through towards predefined arrows (left, middle and right) instead of moving a player I completely removed it due to the Arcade Machine's limitations. The platform is split into 3 vertical lanes, with an arrow at the end of each lane. Each arrow contains a HitZone object with a box collider to detect any enemies inside. If an enemy is detected, it is added to a list, but removed if the next beat already came and there was no user interaction or if the player gave the correct input.
The enemies are spawned at the further end of the platform and need 8 beats to reach the arrows. The spawning is controlled by the EnemySpawner object, that instantiates an enemy prefab on a lane, rotates it to face the camera. The spawning logic entirely depends on a BeatMapSO object, which is a Sriptable Object containing data for enemy type, lane and beat numbers to spawn on. The drawback of this approach is that I must manually enter all values if I want an enemy to spawn, but this way I have complete control over the actions that need to be taken by the player to be successful, hence making the game feel more natural and fun. 
As everything revolves around the music and its beat, the most important part of this game is the AudioManager in every level. To make adding more levels in the future easier, I have decided to make this object a prefab, as I manually have to link the source song, the beatmap and the BPM (beats per minute) value for every song. As soon as a song starts, a beat interval is calculated (60 divided by the BPM) and this value is used to send trigger an event of type System.Action<int> called OnBeat with the current beat number as a parameter. This is the value used by the EnemySpawner and in the EnemyMove script. Movement is very simple. At first I made the movement happen exactly on the beat with high speed, basically enemies just snapped to the next position, but something was off. How can the player hit the enemies on beat if they move on the beat? They cannot. So I added a slight delay of 0.2 seconds to their movement, so technically they do not move on beat, but the user feels like they do. This has solved this problem amazingly. 
Despite wanting to keep the code DRY, I had to repeat the beat number logic in the hit detection script called RhythmInputManager, as I needed access to the previous and next beats to determine if the user hit the target in a given time window (0.2 seconds). This goes against my beliefs, but I could not figure out a better solution yet. 

